from PyWinda import dfm_module as dfm
import numpy as np
import pytest

def test_normal_dist():
    assert (np.allclose(dfm.normal_dist(0.0,1.0),[[1.4867195147342977e-06, 2.4510610429423306e-06, 3.999890372416626e-06, 6.461166392648795e-06, 1.0331006581321705e-05, 1.6350958895825313e-05, 2.561608119513828e-05, 3.972382238141482e-05, 6.0975903952989696e-05, 9.264763532301418e-05, 0.000139341123134969, 0.00020744030876792066, 0.0003056862254780555, 0.000445889724807599, 0.000643795497926865, 0.0009201047696229659, 0.001301653841648913, 0.0018227310960012768, 0.0025264957781039343, 0.0034664379189757624, 0.004707790763123339, 0.006328776428582762, 0.008421534484118353, 0.011092554839374866, 0.01446241479763419, 0.018664609934066448, 0.023843274502042874, 0.030149613916800638, 0.03773692314063993, 0.046754142406705466, 0.05733800512481293, 0.06960395839232576, 0.0836361772145172, 0.09947713879274872, 0.11711735953274449, 0.13648600918747045, 0.15744318761884366, 0.17977466512481263, 0.20318983550122394, 0.22732350563136094, 0.2517419469842393, 0.27595337147011534, 0.29942268327109967, 0.3215900234094101, 0.34189229416612926, 0.35978655781262325, 0.3747739794063901, 0.3864228530895687, 0.3943892340049188, 0.39843380169134646, 0.39843380169134646, 0.3943892340049188, 0.3864228530895687, 0.3747739794063901, 0.35978655781262336, 0.34189229416612926, 0.3215900234094101, 0.29942268327109967, 0.2759533714701155, 0.2517419469842393, 0.22732350563136094, 0.20318983550122394, 0.17977466512481274, 0.15744318761884377, 0.13648600918747045, 0.11711735953274449, 0.09947713879274865, 0.08363617721451726, 0.0696039583923258, 0.05733800512481293, 0.046754142406705466, 0.037736923140639964, 0.030149613916800676, 0.023843274502042874, 0.018664609934066448, 0.014462414797634209, 0.01109255483937488, 0.008421534484118353, 0.006328776428582762, 0.004707790763123343, 0.003466437918975756, 0.0025264957781039343, 0.0018227310960012815, 0.001301653841648913, 0.0009201047696229674, 0.0006437954979268627, 0.000445889724807599, 0.0003056862254780566, 0.00020744030876792028, 0.000139341123134969, 9.26476353230145e-05, 6.0975903952989696e-05, 3.972382238141496e-05, 2.5616081195138144e-05, 1.6350958895825313e-05, 1.0331006581321742e-05, 6.461166392648795e-06, 3.999890372416626e-06, 2.451061042942322e-06, 1.4867195147342977e-06]
        ,[-5.         , -4.8989899  ,-4.7979798  ,-4.6969697  ,-4.5959596 , -4.49494949,
          -4.39393939 , -4.29292929 ,-4.19191919 ,-4.09090909 ,-3.98989899, -3.88888889,
          -3.78787879 , -3.68686869 ,-3.58585859 ,-3.48484848 ,-3.38383838, -3.28282828,
          -3.18181818 , -3.08080808 ,-2.97979798 ,-2.87878788 ,-2.77777778, -2.67676768,
          -2.57575758 , -2.47474747 ,-2.37373737 ,-2.27272727 ,-2.17171717, -2.07070707,
          -1.96969697 , -1.86868687 ,-1.76767677 ,-1.66666667 ,-1.56565657, -1.46464646,
          -1.36363636 , -1.26262626 ,-1.16161616 ,-1.06060606 ,-0.95959596, -0.85858586,
          -0.75757576 , -0.65656566 ,-0.55555556 ,-0.45454545 ,-0.35353535, -0.25252525,
          -0.15151515 , -0.05050505 , 0.05050505 , 0.15151515 , 0.25252525,  0.35353535,
           0.45454545  , 0.55555556  ,0.65656566  ,0.75757576  ,0.85858586 , 0.95959596,
           1.06060606  , 1.16161616  ,1.26262626  ,1.36363636  ,1.46464646 , 1.56565657,
           1.66666667  , 1.76767677  ,1.86868687  ,1.96969697  ,2.07070707 , 2.17171717,
           2.27272727  , 2.37373737  ,2.47474747  ,2.57575758  ,2.67676768 , 2.77777778,
           2.87878788  , 2.97979798  ,3.08080808  ,3.18181818  ,3.28282828 , 3.38383838,
           3.48484848  , 3.58585859  ,3.68686869  ,3.78787879  ,3.88888889 , 3.98989899,
           4.09090909  , 4.19191919  ,4.29292929  ,4.39393939  ,4.49494949 , 4.5959596 ,
           4.6969697   , 4.7979798   ,4.8989899   ,5.        ]]))==True