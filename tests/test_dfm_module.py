from PyWinda import dfm_module as dfm
import numpy as np
import pytest

def test_pdf_normal():
    assert (np.allclose(dfm.pdf_normal(0.0,1.0,seed=148,num=100)[0],[ 0.18868662, -0.80975309,  2.33575683,  0.55858821,  0.14168833,
       -1.22368122, -1.84050654, -2.76319927, -1.04212375, -0.33879244,
       -1.02528385,  2.1871961 ,  2.18721923, -0.68487445,  0.26683629,
       -1.10677712, -1.65423322, -0.01348684, -1.62903789, -0.6988509 ,
        1.16403482,  0.80072846,  0.86464081,  0.21391244,  1.29972889,
        0.25431188,  0.87363066,  0.14653901,  1.10775475,  1.74340249,
       -0.1560486 ,  1.40359769, -0.57178988,  0.97640412, -0.43517653,
       -0.54228647, -0.10227569,  0.50714793,  0.47417999,  0.27742528,
        2.22349794, -1.40864747,  0.72953998, -0.98273785, -0.29739488,
       -0.4452313 ,  1.40155735, -0.47083853, -0.12183741, -0.57804947,
       -0.68492377, -0.56446034,  0.00614665, -0.4924916 ,  0.47483588,
        0.88247285, -0.41055318,  0.04390609,  1.11419096,  0.20996179,
        0.75889711,  1.64089259, -0.17049344,  1.46478433, -0.76975274,
       -1.22220699, -0.28039157, -0.36240189,  0.9945021 ,  0.11473708,
        1.20237439, -1.3004684 , -2.21445444, -0.02045522,  0.25774274,
        0.63405607, -1.07111456,  1.40360241, -0.46502957, -2.79320191,
       -0.44789496, -0.12429724, -0.79619231,  1.06550193, -0.42762779,
        0.60468994,  2.04572711, -1.48333015, -2.28023135, -1.21608452,
        0.71850531, -0.69268269, -0.16426964,  1.14178154,  0.25856905,
        1.09632706, -0.52410269,  1.1038902 ,  0.68912778, -0.29213815]))==True

def test_cdf_normal_1sigma():
    samples,cdf,x=dfm.cdf_normal(mean=0,sd=1,x=1,seed=1480,num=15000)
    samples1,cdf1,x=dfm.cdf_normal(mean=0,sd=1,x=-1,seed=1480,num=15000)
    check=max(cdf)-max(cdf1)
    assert (check)==0.6855067884205934

def test_cdf_normal_2sigma():
    sam,cdf,x=dfm.cdf_normal(0,1,2,seed=500)
    sam1,cdf1,x1=dfm.cdf_normal(0,1,-2,seed=500)
    check=max(cdf)-max(cdf1)
    assert (check)==0.9670053692457227

def test_cdf_normal_3sigma():
    sam,cdf,x=dfm.cdf_normal(0,1,3,seed=405)
    sam1,cdf1,x=dfm.cdf_normal(0,1,-3,seed=405)
    check=max(cdf)-max(cdf1)
    assert (check)==0.9969924662069076

def test_cdf_normal_5sigma():
    sam,cdf,x=dfm.cdf_normal(0,1,3.5,seed=123,num=10000)
    sam1,cdf1,x=dfm.cdf_normal(0,1,-3.5,seed=123,num=10000)
    check=max(cdf)-max(cdf1)
    assert (check)==0.9995016294927809
